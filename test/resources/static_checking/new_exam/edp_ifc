CO(cid:Integer)
P(id:String; cid:Integer)
Public
;
Public flows P
Public flows CO
;

// supply fault scenario
(fault:fault) (Public) [?] [P(#id; #cid as X) -> CO(cid=X)]

(r4c:request_forecast) (CO(cid:Bot), P(id:Bot; cid:Bot)) [?: {cid:Integer}] [CO(#cid as X) -> P(id=*; cid=X)]
%(accounting:accounting) (CO(cid:Bot), P(id:Bot; cid:Bot)) [?] [CO(#cid as X)]

(csm:consume) ( P(id:Bot; cid:Bot)) [?] [P(#id; #cid as X) -> P(id=*; cid=X)]
;
accounting -->% accounting
r4c -->% csm

r4c -->> {
  (reply: reply) (CO(cid:Bot), P(id:Bot; cid:Bot)) [?:Integer] [@Receiver(r4c) -> @Initiator(r4c)]
  ;
  reply -->% reply
  reply *--> accounting
  reply -->+ accounting, csm
}

csm -->> {
  (reply: reply) (P(id:@trigger.initiator.id; cid:@trigger.initiator.cid),P(id:@trigger.receiver.id; cid:@trigger.receiver.cid)) [?:Integer] [@Receiver(csm) -> @Initiator(csm)]
  //(reply: reply) (P(id:Bot; cid:@trigger.value.cid)) [?:Integer] [@Receiver(csm) -> @Initiator(csm)]
  ;
  reply -->% reply
  reply -->> {
    (accept: accept) (P(id:@trigger.initiator.id; cid:@trigger.initiator.cid),P(id:@trigger.receiver.id; cid:@trigger.receiver.cid)) [?] [@Initiator(csm) -> @Receiver(csm)]
    (reject: reject) (P(id:@trigger.initiator.id; cid:@trigger.initiator.cid),P(id:@trigger.receiver.id; cid:@trigger.receiver.cid)) [?] [@Initiator(csm) -> @Receiver(csm)]
    ;
    accept, reject -->% accept, reject
  }
}